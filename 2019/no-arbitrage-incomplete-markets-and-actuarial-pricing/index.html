<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>Certum ex Incertis - No Arbitrage, Incomplete Markets and Actuarial Pricing</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="Certum ex Incertis">
<meta name="generator" content="Hugo 0.145.0">

    
    

  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    menuSettings: { zoom: "Double-Click" },
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  },
     "HTML-CSS" : {
         availableFonts : ["TeX"],
         preferredFont : "TeX",
         webFont : "TeX",
         imageFont : null
     }
 });
</script>

<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>







<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">


    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">








<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">


<link rel="stylesheet" href="http://localhost:1313/css/tufte.css">
<link rel="stylesheet" href="http://localhost:1313/css/hugo-tufte.css">
<link rel="stylesheet" href="http://localhost:1313/css/hugo-tufte-override.css">

    
</head>

<body>
    <div id="layout" class="pure-g">
        <article class="pure-u-1">
            <header class="brand">
  <h1>Certum ex Incertis</h1>
  <h2>Dimitri Semenovich</h2>
  <nav class="menu">
    <ul>
    
    
        <li><a class='' href="/">Home</a></li>
    
        <li><a class='' href="/post/">Archive</a></li>
    
        <li><a class='' href="/talks/">Talks</a></li>
    
        <li><a class='' href="/papers/">Papers</a></li>
    
        <li><a class='' href="/about/">About</a></li>
    
    </ul>
</nav>

</header>

            <section style="padding-bottom:0px;">
<h1 class="content-title" style="margin-bottom:0.5rem">
  
  <a href="/2019/no-arbitrage-incomplete-markets-and-actuarial-pricing/">No Arbitrage, Incomplete Markets and Actuarial Pricing</a>
  
</h1>





<span class="content-meta">
    
    
    Mar 15, 2019&nbsp;&nbsp;
    
    
    
    <nav class="tags" style="display:inline-block; width:80%;">
        <ul >
            
            <li><a  href="http://localhost:1313/tags/finance">finance</a> </li>
            
            <li><a  href="http://localhost:1313/tags/actuarial">actuarial</a> </li>
            
            <li><a  href="http://localhost:1313/tags/mathematical-optimization">mathematical-optimization</a> </li>
            
            <li><a  href="http://localhost:1313/tags/pricing">pricing</a> </li>
            
        </ul>
    </nav>
    
</span>



</section>

            <section style="padding-top:7px;"><p>In this post I&rsquo;ll explore the linear pricing model and its connection to actuarial pricing. I&rsquo;ll demystify &ldquo;risk-neutral probabilities&rdquo; - which aren&rsquo;t truly probabilities in any meaningful sense, but rather artifacts of optimal portfolio selection. My aim is to clarify these concepts which often remain poorly explained in standard textbooks, highlighting the surprising equivalence between financial and actuarial approaches to pricing.</p>
<h2 id="two-stage-linear-pricing-model">Two stage linear pricing model</h2>
<p>Let&rsquo;s consider a two period model where the state of the world at $t=0$ is assumed known. At time $t=1$ there can be $n$ distinct states, $\omega_1,\omega_2, \ldots, \omega_n$ with an associated probabilities vector $\mathbf{p} \in \mathbb{R}^n$.</p>
<p>We have $m$ available securities where the $i$-th security has a pay-off vector $\mathbf{s}^{(i)} \in \mathbb{R}^n$ at $t=1$ and a price $d^{(i)} \in \mathbb{R}$ at $t=0$.</p>
<p>We can combine prices into a vector $\mathbf{d} \in \mathbb{R}^m$ with:
$$\mathbf{d} = \left[d^{(1)}, d^{(2)},\ldots,d^{(n)} \right]^T$$</p>
<p>And pay-off vectors into a matrix $S \in \mathbb{R}^{n \times m}$ such that:
$$S = \left[\mathbf{s}^{(1)}, \mathbf{s}^{(2)}, \ldots,\mathbf{s}^{(m)}\right]$$</p>
<p><label for="marginnote-58ee9cce768dae329b1207a903be93c8-0" class="margin-toggle">⊕</label>
<input type="checkbox" id="marginnote-58ee9cce768dae329b1207a903be93c8-0" class="margin-toggle"/>
<span class="marginnote"> <img src="/img/financial_economics/linear_pricing.png" alt=""> <strong>Figure 1:</strong> Linear pricing diagram showing securities with prices at $t=0$ and their payoffs at $t=1$ across different states. </span></p>
<p>Here&rsquo;s how a very simple insurance problem might look in this setting:</p>
<p><label for="marginnote-58ee9cce768dae329b1207a903be93c8-1" class="margin-toggle">⊕</label>
<input type="checkbox" id="marginnote-58ee9cce768dae329b1207a903be93c8-1" class="margin-toggle"/>
<span class="marginnote"> <img src="/img/financial_economics/insurance.png" alt=""> <strong>Figure 2:</strong> Insurance example showing the premium payment at $t=0$ and the potential policy payoffs under different states at $t=1$. </span></p>
<p>The key assumption is that the prices are &ldquo;linear&rdquo; i.e. if we purchase $\theta^{(i)}$ of the $i$-th asset at time $t=0$ the pay-off vector $\mathbf{s} \in \mathbb{R}^n$ at $t=1$ will be:
$$\mathbf{s}=\sum_{i=1}^m \theta^{(i)}\mathbf{s}^{(i)} = S\mathbf{\theta}$$</p>
<p>This is generally far from true - we can negotiate better unit prices for big orders, it&rsquo;s harder to insure large risks, etc. The assumption works well enough for trades in liquid securities, especially when there are no issues of control or revealing private information.</p>
<h2 id="betting-arbitrage">Betting arbitrage</h2>
<p>We can use this set up for &ldquo;riskless&rdquo; arbitrage in the betting market where $e$ is the initial outlay:
$$\begin{eqnarray}
&amp; \underset{\mathbf{\theta}}{\text{maximize}} &amp;&amp; E(S\mathbf{\theta}) = \mathbf{p}^TS\mathbf{\theta} \nonumber \\
&amp; \text{subject to} &amp;&amp; \mathbf{\theta} \ge \mathbf{0} \nonumber \\
&amp; &amp;&amp; \mathbf{d}^T \mathbf{\theta} \le e \nonumber \\
&amp; &amp;&amp; S\mathbf{\theta} &gt; e \nonumber
\end{eqnarray}$$</p>
<p>Every feasible point provides a &ldquo;riskless&rdquo; profit and we select the one with highest expected pay-off (using our assessment of probabilities). If there are no arbitrage opportunities, the problem is infeasible.</p>
<p>If we allow borrowing to finance the bets, we can drive the expected pay off to infinity, which is of course a good thing!</p>
<p>The main reason people worry about arbitrage is because they want to avoid it in the prices they quote - otherwise they are on the losing end of an &ldquo;infinite&rdquo; expected utility pay off. Arbitrage between <em>different</em> sellers merely helps the market to reach equilibrium prices.</p>
<h2 id="state-prices">State prices</h2>
<p>Any pay-off vector $\mathbf{s} \in \mathbb{R}^n$ for which there exist $\mathbf{\theta} \in \mathbb{R}^m$ such that $\mathbf{s}=S\mathbf{\theta}$ is called <em>attainable</em>.</p>
<p>It&rsquo;s a basic result in linear algebra that if there are at least $n$ securities with linearly independent pay-offs, <em>any</em> new pay-off vector can be represented as a linear combination of existing securities, i.e. become <em>attainable</em>.</p>
<p>The prices for different &ldquo;portfolios&rdquo; with the same pay-offs needn&rsquo;t be the same. If this is the case and short-selling/borrowing is allowed we can achieve infinite expected return with no chance of loss - &ldquo;arbitrage&rdquo;.</p>
<p>The &ldquo;fundamental theorem of asset pricing&rdquo; characterizes when arbitrage opportunities exist - by LP duality the first problem is unbounded (i.e. arbitrage exists) if and only if the second problem is infeasible (i.e. there are no $\mathbf{\lambda}$ satisfying the constraints):</p>
<p>Left problem (primal):
$$\begin{eqnarray}
&amp; \underset{\mathbf{\theta}}{\text{minimize}} &amp;&amp; \mathbf{d}^T\mathbf{\theta} \nonumber \\
&amp; \text{subject to} &amp;&amp; S\mathbf{\theta} \ge \mathbf{0} \nonumber
\end{eqnarray}$$</p>
<p>Right problem (dual):
$$\begin{eqnarray}
&amp; \underset{\mathbf{\lambda}}{\text{maximize}} &amp;&amp; \mathbf{0}^T\mathbf{\lambda} \nonumber \\
&amp; \text{subject to} &amp;&amp; S^T\mathbf{\lambda} = \mathbf{d} \nonumber \\
&amp; &amp;&amp; \mathbf{\lambda} \ge 0 \nonumber
\end{eqnarray}$$</p>
<p>Therefore if we can exhibit $\mathbf{\lambda}^*$ satisfying the constraints of the second problem, we can certify that the structure of prices and pay-offs offers no arbitrage opportunities.</p>
<p>The vector $\lambda$ has a natural interpretation as a vector of &ldquo;state prices&rdquo; e.g. prices of simple pay-off vectors $\mathbf{e}^{(i)}$ which return 1 in the $i$-th state and $0$ otherwise (these are known as Arrow-Debreu securities).</p>
<p><label for="marginnote-58ee9cce768dae329b1207a903be93c8-2" class="margin-toggle">⊕</label>
<input type="checkbox" id="marginnote-58ee9cce768dae329b1207a903be93c8-2" class="margin-toggle"/>
<span class="marginnote"> <img src="/img/financial_economics/state_prices.png" alt=""> <strong>Figure 3:</strong> State prices diagram showing how we can think of security prices in terms of the prices of their constituent Arrow-Debreu payoffs. </span></p>
<p>If every pay-off vector is attainable (and there is no arbitrage), state prices exist and are unique - this is called a <em>complete market</em>. Price of any pay-off vector $\mathbf{x} \in \mathbf{R}^n$ is given as $\mathbf{x}^T\mathbf{\lambda}^*$.</p>
<p>If there is no arbitrage yet not every pay-off is attainable, there are (infinitely) many sets of state prices $\mathbf{\lambda}$ that satisfy $S^T\mathbf{\lambda} = \mathbf{d}$ - in this case the market is called <em>incomplete</em>.</p>
<p>State prices are often normalized to sum to one and subsequently referred to as &ldquo;risk neutral probabilities&rdquo; - these do not seem to have a clear economic interpretation.</p>
<p>Most of the classical results in financial economics concern <em>complete</em> markets, with completeness derived from extraordinarily strong assumptions about price dynamics. The insurance market is so far from being complete that the point is seldom brought up.</p>
<h2 id="portfolio-optimisation">Portfolio optimisation</h2>
<p>Many models in financial economics and insurance can be reduced to a control problem maximizing expected utility (or some related objective) subject to a budget constraint $e$ - these include MPT, CAPM, optimal reinsurance, asset liability matching etc.
$$\begin{eqnarray}
&amp; \underset{\mathbf{\theta}}{\text{maximize}} &amp;&amp; E\big(u(\mathbf{c})\big) = \sum_{j=1}^n u(c_j) p_j \nonumber \\
&amp; \text{subject to} &amp;&amp; c_j = \sum_{i=1}^m \theta^{(i)}\left(s^{(i)}_j - d^{(i)}\right), \ \ j=1,2,\ldots,n \nonumber \\
&amp; &amp;&amp; \mathbf{d}^T \mathbf{\theta} \le e \nonumber
\end{eqnarray}$$</p>
<p>The market prices are assumed to be given; it&rsquo;s generally difficult to estimate both the utility function and real world probabilities.</p>
<p>In complete markets, we can find the optimal consumption profile directly and then determine the corresponding replicating portfolio in a separate step.</p>
<p>This approach can also be used for &ldquo;marginal&rdquo; pricing of new securities in incomplete markets, i.e. at what price level does a security drop out of the optimal portfolio - this is specific to the agent and does not necessarily correspond to the market prices.</p>
<p>Marginal pricing only considers acquiring a very small portion of the security whereas often it needs to be purchased in its entirety or not at all.</p>
<h2 id="incomplete-markets---no-arbitrage-bounds">Incomplete markets - no arbitrage bounds</h2>
<p>In an incomplete market we can attempt to construct bounds on the price of a new pay-off $\mathbf{x}$, e.g. it needs to be cheaper than the cheapest portfolio of marketed securities that pays as much or more in every state.</p>
<p>Left problem (primal):
$$\begin{eqnarray}
&amp; \underset{\mathbf{\theta}}{\text{minimize}} &amp;&amp; \mathbf{d}^T\mathbf{\theta} \nonumber \\
&amp; \text{subject to} &amp;&amp; S\mathbf{\theta} \ge \mathbf{x} \nonumber
\end{eqnarray}$$</p>
<p>Right problem (dual):
$$\begin{eqnarray}
&amp; \underset{\mathbf{\lambda}}{\text{maximize}} &amp;&amp; \mathbf{x}^T\mathbf{\lambda} \nonumber \\
&amp; \text{subject to} &amp;&amp; S^T\mathbf{\lambda} = \mathbf{d} \nonumber \\
&amp; &amp;&amp; \mathbf{\lambda} \ge 0 \nonumber
\end{eqnarray}$$</p>
<p>This problem can be expressed in terms of portfolio weights (<em>left</em>) or state prices (<em>right</em>) - the latter searches for the state price vector resulting in the highest price for pay-off $\mathbf{x}$ and yet compatible with prices of marketed securities. The two formulations are related via LP duality.</p>
<h2 id="indifference-bounds">Indifference bounds</h2>
<p>No arbitrage bounds are usually far too wide - for the insurance example they would be $0$ and $100$, the maximum possible loss.</p>
<p>We can construct a tighter bound on price by requiring that the price we charge for a security results in expected utility at least as high as that of the baseline portfolio.
$$\begin{eqnarray}
&amp; \underset{\mathbf{\theta}}{\text{minimize}} &amp;&amp; \mathbf{d}^T\mathbf{\theta} \nonumber \\
&amp; \text{subject to} &amp;&amp; E\big(u(S\mathbf{\theta} \text{ - } \mathbf{x})\big) \ge E\big(u(0)\big) \nonumber
\end{eqnarray}$$</p>
<p>This is indeed equivalent to the venerable &ldquo;equivalent utility&rdquo; pricing principle from the actuarial literature:
$$u(0)=E\big(u(\theta \text{ - } \mathbf{x})\big)$$</p>
<p>The approach also extends tho the multi-period settings:</p>
<p><label for="marginnote-58ee9cce768dae329b1207a903be93c8-3" class="margin-toggle">⊕</label>
<input type="checkbox" id="marginnote-58ee9cce768dae329b1207a903be93c8-3" class="margin-toggle"/>
<span class="marginnote"> <img src="/img/financial_economics/binomial_lattice.png" alt=""> <strong>Figure 4:</strong> Binomial lattice model showing how asset prices and portfolio decisions evolve over time in a multi-period discrete-time setting. </span></p>
<p>$$\begin{eqnarray}
&amp; \underset{\mathbf{\theta}_1, \ldots, \mathbf{\theta}_n}{\text{minimize}} &amp;&amp; S_0\mathbf{\theta}_0 \nonumber \\
&amp; \text{subject to} &amp;&amp; S_n(\mathbf{\theta}_n - \mathbf{\theta}_{a(n)}) = 0,\ \ n \in \mathcal{N}_t,\ \ t \ge 1 \nonumber \\
&amp; &amp;&amp; S_n\mathbf{\theta}_n \ge \mathbf{x},\ \ n \in \mathcal{N}_T \nonumber
\end{eqnarray}$$</p>
<h2 id="the-unified-approach-to-financial-and-actuarial-pricing">The unified approach to financial and actuarial pricing</h2>
<p>Essentially all problems studied in financial economics can be reduced to maximizing the utility of consumption under a real world probability measure (see J. Cochrane, &ldquo;Asset Pricing&rdquo;). While financial engineering primarily deals with state prices, &ldquo;risk neutral&rdquo; probabilities, and pricing kernels, actuarial science approaches the same problems directly through utility theory.</p>
<p>The key insight is that in incomplete markets, these seemingly different methods are formally related through Lagrange duality to the same fundamental problem: selecting expected utility maximizing portfolios under real world probability measures.</p>
<p>The &ldquo;actuarial&rdquo; approach to pricing risks isn&rsquo;t fundamentally different from the &ldquo;financial engineering approach&rdquo; - it simply focuses explicitly on the more challenging and realistic setting of incomplete markets!</p>
</section>
            <section>
                <nav class="menu" style="margin-top:0rem">
                    <ul style="display: flex;
                               align-items: stretch;
                               justify-content: space-between;">
                        <li>
                            <a href="/2018/the-kalman-filter-tutorial-that-might-at-last-make-sense/">&larr; Next Post</a>  
                        </li>
                        
                        <li>
                            <a href="/2023/basic-theory-of-entity-resolution/">Previous Post &rarr;</a>
                        </li>
                        
                    </ul>
                </nav>        
                

                <footer class="page-footer">
		<hr>
		<ul class="page-footer-menu">
		
		</ul>

  

	<div class="copyright">
	<p>
    
      &copy; 2025
    .
    All rights reserved.
    
  </p>
</div>
</footer>



            </section>
        </article>
    </div>
</body>
</html>
